# Phase 8: 모바일 UX 및 폼 안정성

PWA 적용 후 모바일 네이티브 앱과 같은 사용자 경험을 위한 필수적인 UX 개선과 폼 처리 안정성을 강화합니다.

## 🎯 목표

- 모바일 입력 환경 최적화 (확대/축소 제어)
- 폴더 생성 UX 개선 (페이지 이동 없이 모달로 처리)
- 중복 제출 방지 (연타 방지)

## 📋 작업 목록

### 8.1 모바일 확대/축소 차단

#### 문제점
- iOS Safari에서 input 포커스 시 자동 확대되어 불편함
- 핀치/스와이프로 확대/축소가 가능하여 앱 같은 느낌이 떨어짐

#### 해결 방안
- [x] **viewport 메타 태그 설정**
  - `maximum-scale=1.0`: 최대 확대 비율 제한
  - `user-scalable=no`: 사용자 확대/축소 비활성화
  - 적용 위치: `src/app/layout.tsx`의 viewport export
  - **참고**: iOS Safari는 viewport 메타 태그를 접근성 정책으로 무시함

- [x] **iOS Safari 및 Android 핀치 줌 차단**
  - `usePreventZoom` 훅 생성 (`src/shared/hooks/usePreventZoom.ts`)
  - iOS: gesturestart/change/end 이벤트 차단
  - Android: 멀티터치 및 더블탭 이벤트 차단
  - CSS: `touch-action: pan-y` 적용으로 상하 스크롤만 허용
  - 적용 위치: `src/shared/components/layout/client-layout.tsx`

---

### 8.2 모달 기반 폴더 생성

#### 문제점
- 북마크 생성/수정 중 폴더를 추가하려면 `/folder/manage` 페이지로 이동해야 함
- 페이지 이동 시 입력했던 북마크 정보가 모두 사라짐
- 폴더 생성 후 돌아와서 다시 입력해야 하는 불편함

#### 해결 방안
- [ ] **폴더 폼 컴포넌트 분리**
  - `/folder/manage/_components/folder-form.tsx` 생성
  - 폼 로직을 재사용 가능한 컴포넌트로 분리
  - 생성/수정 모드 지원

- [ ] **북마크 페이지에 폴더 생성 모달 추가**
  - `/bookmark/create`, `/bookmark/[id]/edit`에 모달 추가
  - "새 폴더" 버튼 클릭 시 모달 열림
  - 분리된 `folder-form` 컴포넌트 재사용

- [ ] **폴더 생성 후 자동 선택**
  - 모달에서 폴더 생성 성공 시 모달 닫힘
  - 생성된 폴더가 자동으로 선택됨
  - 북마크 입력 데이터는 그대로 유지

- [ ] **폴더 관리 페이지 유지**
  - `/folder/manage` 페이지는 기존대로 유지
  - 향후 대량 폴더 관리 용도로 활용

---

### 8.3 중복 제출 방지

#### 문제점
- 폴더/북마크 생성 버튼 연타 시 여러 개가 생성됨
- 네트워크 지연 시 사용자가 여러 번 클릭할 가능성

#### 해결 방안
- [ ] **Mutation `isPending` 상태 활용**
  - 제출 중에는 버튼 비활성화
  - 로딩 상태 표시 ('저장 중...')

- [ ] **적용 대상**
  - 북마크 생성/수정 폼 (`/bookmark/create`, `/bookmark/[id]/edit`)
  - 폴더 생성/수정 폼 (`/folder/manage`)
  - 즐겨찾기 토글 (`FavoriteButton`)
  - 삭제 버튼 (`MoreButton`)

---

## 💡 구현 방향성

### 모바일 확대/축소 차단
- viewport 메타 태그로 확대/축소 동작 완전 제어
- PWA 네이티브 앱처럼 동작하도록 설정

### 모달 기반 폴더 생성
- 폴더 폼 로직을 독립적인 컴포넌트로 분리하여 재사용성 확보
- 모달 내에서 폴더 생성 완료 → React Query로 폴더 목록 자동 갱신
- 생성된 폴더의 ID를 모달 닫힘 시 부모 컴포넌트에 전달하여 자동 선택
- 페이지 이동 없이 모든 작업이 한 화면에서 완결

### 중복 제출 차단
- React Query의 `isPending` 상태를 버튼의 `disabled` 속성과 연결
- `isPending` 상태에 따라 버튼 텍스트 및 스타일 변경하여 시각적 피드백 제공

---

## 📊 예상 효과

### 사용자 경험
- **네이티브 앱 경험**: 확대/축소 차단으로 모바일 앱처럼 동작
- **원활한 폴더 생성**: 페이지 이동 없이 모달로 즉시 폴더 추가, 데이터 유실 없음
- **즉각적인 피드백**: 폴더 생성 후 자동 선택, 부드러운 UX
- **안정성**: 네트워크 지연 상황에서도 중복 생성 차단

### 개발
- viewport 메타 태그 1줄로 확대/축소 이슈 완전 해결
- 컴포넌트 재사용으로 코드 중복 최소화 (폴더 폼 컴포넌트)
- 기존 React Query 패턴 활용으로 추가 라이브러리 불필요
- localStorage Draft 불필요 → 복잡도 감소